<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Signup</title>
  <link rel="stylesheet" href="/src/signup.css">
  <script src="https://kit.fontawesome.com/859dd79601.js" crossorigin="anonymous"></script>
</head>
<body>
  <div class="container">
    <div class="form-box">
      <h1 id="title">Sign Up</h1> 
      <form action="">
        <div class="input-group">
          <div class="input-field" id="Namefield">
            <i class="fa-solid fa-user"></i>
            <input type="text"  autocomplete="off" placeholder=" Enter your Name">
          </div>
          <div class="input-field">
            <i class="fa-solid fa-envelope"></i>         
            <input type="email" autocomplete="off"  placeholder=" Enter your Email or username">
          </div>
          <div class="input-field">
            <i class="fa-solid fa-lock"></i>  
            <input type="password" autocomplete="off"  placeholder=" Enter your password">
          </div>
          <div class="input-field">
            <i class="fa-solid fa-phone"></i>
            <input type="tel" id="phoneField" placeholder="phone no">
          </div>
          <!-- <p id="Forgot"> <a href="#">Forgot password</a></p> -->
          <!-- <div class="input-field otp-field hidden">  <i class="fa-solid fa-hashtag"></i>  
            <input type="number"  autocomplete="off"  placeholder=" Enter OTP">
          </div> -->
        </div>
        <div class="btn-field">
          <button type="button" id="signupbtn">Sign up</button>
          <p id="status"></p>
          <!-- <button type="button" id="home-btn" class="disable" style="margin-left:125px;;font-weight: 700;font-size:1.5em;"><a style="text-decoration: none;"  href="index.html" class="home-btn">Home</a>  </div>
          </div></button> -->
      
        
      </form>
      
    </div>
  </div>
  <script>
    let signupButton = document.getElementById("signupbtn");
    let Namefield = document.querySelector("#Namefield input");
    let emailField = document.querySelector(".input-field:nth-child(2) input");
    let passwordField = document.querySelector(".input-field:nth-child(3) input");
    let phoneField = document.getElementById("phoneField");
  
    signupButton.onclick = async function() {
      let userData = {
        name: Namefield.value,
        email: emailField.value,
        password: passwordField.value,
        phonenumber: parseInt(phoneField.value)
      };

let headersList = {
 "Content-Type": "application/json"
}

let bodyContent = JSON.stringify(userData);

console.log(bodyContent);

let response = await fetch("http://localhost:5000/api/auth/createuser", { 
  method: "POST",
  body: bodyContent,
  headers: headersList
});

let data = await response.json();
console.log(data);
localStorage.setItem("authtoken", data.authtoken);
if(data.authtoken == null){
  document.getElementById("status").innerHTML = "Signup Failed";
}
if (data.authtoken) {
  window.location.href = "auctions.html";
}
    };
  
    // Restrict input to 10 digits for phone number
    phoneField.addEventListener("input", function() {
      let phoneRegex = /^\d{0,10}$/;
      if (!phoneRegex.test(phoneField.value)) {
        phoneField.value = phoneField.value.slice(0, 10); 
      }
    });
  </script>
  
</body>

</html>